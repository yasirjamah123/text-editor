(()=>{const e=document.getElementById("textarea"),n=document.getElementById("output"),t=document.getElementById("currentLine");function o(){const e=indexedDB.open("text_editor",1);e.onsuccess=function(){const o=e.result.transaction("entries","readonly").objectStore("entries").get(1);o.onsuccess=function(){const e=o.result;if(e&&e.content){const o=e.content.split("\n");n.innerHTML="";let c=1;o.forEach((e=>{const t=document.createElement("div");t.classList.add("line"),t.innerHTML=`<span class="line-no">${c}</span><span class="line-content">${e}</span>`,n.appendChild(t),c++})),t.textContent=c}}}}e.addEventListener("keydown",(function(c){"Enter"===c.key&&(c.preventDefault(),function(c){const s=indexedDB.open("text_editor",1);s.onsuccess=function(){const i=s.result.transaction("entries","readwrite"),d=i.objectStore("entries"),u=d.get(1);n.innerHTML="",e.value="","clear"===c?(d.put({id:1,content:""}),i.oncomplete=function(){console.log("Cleared from IndexedDB"),o(),t.textContent=1}):u.onsuccess=function(){const e=u.result;let n=c;e&&e.content&&(n=e.content+"\n"+c),d.put({id:1,content:n}),i.oncomplete=function(){o(),console.log("Content saved to IndexedDB")}}}}(e.value))})),document.addEventListener("DOMContentLoaded",(function(){e.focus(),o()})),document.getElementById("terminal").addEventListener("click",(function(n){e.focus()}))})();